<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create lighting specification for 3D surface rendering — lighting • ggcube</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create lighting specification for 3D surface rendering — lighting"><meta name="description" content="Creates a lighting specification object that supports both directional lighting
(parallel rays like sunlight) and positional lighting (point light sources with
per-face light directions and optional distance falloff), for use with 3D polygon geoms."><meta property="og:description" content="Creates a lighting specification object that supports both directional lighting
(parallel rays like sunlight) and positional lighting (point light sources with
per-face light directions and optional distance falloff), for use with 3D polygon geoms."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggcube</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/matthewkling/ggcube/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create lighting specification for 3D surface rendering</h1>
      <small class="dont-index">Source: <a href="https://github.com/matthewkling/ggcube/blob/main/R/lighting.R" class="external-link"><code>R/lighting.R</code></a></small>
      <div class="d-none name"><code>lighting.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates a lighting specification object that supports both directional lighting
(parallel rays like sunlight) and positional lighting (point light sources with
per-face light directions and optional distance falloff), for use with 3D polygon geoms.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">lighting</span><span class="op">(</span></span>
<span>  method <span class="op">=</span> <span class="st">"diffuse"</span>,</span>
<span>  direction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  position <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  distance_falloff <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  quanta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  shade <span class="op">=</span> <span class="st">"neither"</span>,</span>
<span>  shade_strength <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  shade_mode <span class="op">=</span> <span class="st">"hsv"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Character string specifying lighting model:</p><ul><li><p><code>"diffuse"</code>: Atmospheric lighting with soft shadows (includes negative values for subsurface scattering effect)</p></li>
<li><p><code>"direct"</code>: Direct lighting with hard shadows (surfaces facing away are completely dark)</p></li>
<li><p><code>"normal_rgb"</code>: Map surface normals to RGB colors</p></li>
<li><p><code>"normal_x"</code>, <code>"normal_y"</code>, <code>"normal_z"</code>: Individual surface normal components (with higher positive values indicating a surface
faces more directly toward the positive end of a given dimension)</p></li>
</ul><p>Default is "diffuse".</p></dd>


<dt id="arg-direction">direction<a class="anchor" aria-label="anchor" href="#arg-direction"></a></dt>
<dd><p>Numeric vector of length 3 specifying direction in 3D space that
light comes from for directional lighting. The default is <code>c(1, 0, 1)</code>, giving
diagonal lighting from the upper right edge with default rotation. Common examples: <code>c(0, 0, 1)</code> gives
overhead lighting, <code>c(1, 0, 0)</code> lights surfaces facing the positive x
direction, and <code>c(-1, -1, 0)</code> lights surfaces facing negative x-y edge. At least
one value must be non-zero. Values are automatically normalized, so magnitude doesn't
matter, only sign and relative magnitude.
This argument is ignored if <code>position</code> is provided.</p></dd>


<dt id="arg-position">position<a class="anchor" aria-label="anchor" href="#arg-position"></a></dt>
<dd><p>Numeric vector of length 3 specifying light source position in
data coordinate space for positional lighting. When specified, each face gets
its own light direction calculated from the light position to the face center.
Mutually exclusive with <code>direction</code>. Default is NULL (use directional lighting).</p></dd>


<dt id="arg-distance-falloff">distance_falloff<a class="anchor" aria-label="anchor" href="#arg-distance-falloff"></a></dt>
<dd><p>Logical indicating whether to apply distance-based
intensity falloff for positional lighting using inverse square law
(intensity ∝ 1/distance²). Only used when <code>position</code> is specified.
Default is FALSE.</p></dd>


<dt id="arg-quanta">quanta<a class="anchor" aria-label="anchor" href="#arg-quanta"></a></dt>
<dd><p>Integer number of discrete quantization levels, or NULL for continuous lighting.
When specified, continuous lighting values are binned into this many discrete levels:</p><ul><li><p>For <code>"diffuse"</code>: Creates equal-width bins across -1, 1 range</p></li>
<li><p>For <code>"direct"</code>: Creates one bin for negative values, and (quanta-1) bins across 0, 1 range</p></li>
</ul><p>Default is NULL (continuous lighting).</p></dd>


<dt id="arg-shade">shade<a class="anchor" aria-label="anchor" href="#arg-shade"></a></dt>
<dd><p>Character string specifying which color aesthetics to modify with shading.
Options: "neither" (no shading), "fill" (shade fill colors only),
"color"/"colour" (shade border colors only), or "both" (shade both fill and border).
Default is "neither".</p></dd>


<dt id="arg-shade-strength">shade_strength<a class="anchor" aria-label="anchor" href="#arg-shade-strength"></a></dt>
<dd><p>Numeric value in the range 0–1 controlling the intensity of shading.
1.0 gives full black-to-white range, 0.5 gives subtle lighting effects.
Only used when <code>shade</code> is not "neither". Default is 1.0.</p></dd>


<dt id="arg-shade-mode">shade_mode<a class="anchor" aria-label="anchor" href="#arg-shade-mode"></a></dt>
<dd><p>Character string specifying color shading mode when <code>shade</code> is not "neither":</p><ul><li><p><code>"hsv"</code>: Modifies HSV value component (fades to bright colors at high end, black at low end)</p></li>
<li><p><code>"hsl"</code>: Modifies HSL lightness component (fades to white at high end, black at low end)</p></li>
</ul><p>Default is "hsv".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>lighting</code> object that can be passed to 3D surface stats.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>There are two approaches for adding lighting to a plot. The first is to use shading. This lets you
add light and shadow effects while also specifying fill/color arguments or aesthatics through
standard ggplot2 methods. Shading alters these colors by brightening and darkening them.</p>
<p>The second approach is to use the computed light variable directly in your aesthetic mapping, such as
<code>aes(fill = after_stat(light))</code>. This gives more control over you map lighting values onto color
scales, but can't be mixed with other sources of color info.</p>
<p>It is also possible to combine these two approaches. For example, using <code>shade = "fill"</code>,
<code>after_stat(light)</code>, and <code><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c()</a></code> will produce a higher-contrast version of
the viridis palette (though the guide will not reflect the shading component).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="stat_surface_3d.html">stat_surface_3d</a></code>, <code><a href="stat_voxel_3d.html">stat_voxel_3d</a></code>, <code><a href="stat_pillar_3d.html">stat_pillar_3d</a></code>, <code>scale_colorbar_shade</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># base plot used in examples</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mountain</span>, <span class="fu"><a href="aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">z</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="coord_3d.html">coord_3d</a></span><span class="op">(</span>scales <span class="op">=</span> <span class="st">"fixed"</span>, ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.5</span>, <span class="fl">.01</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_c</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Aesthetic lighting versus shading -----------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># map default lighting to fill aesthetic</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="stat_surface_3d.html">stat_surface_3d</a></span><span class="op">(</span><span class="fu"><a href="aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">light</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="lighting-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># apply shading to standard fill and color attributes</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="stat_surface_3d.html">stat_surface_3d</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"slateblue"</span>, color <span class="op">=</span> <span class="st">"gray80"</span>,</span></span>
<span class="r-in"><span>                    light <span class="op">=</span> <span class="fu">lighting</span><span class="op">(</span>shade <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="lighting-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># apply shading on top of standard aesthetic mapping</span></span></span>
<span class="r-in"><span><span class="co"># and add a shaded guide to match</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="stat_surface_3d.html">stat_surface_3d</a></span><span class="op">(</span><span class="fu"><a href="aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">z</span>, color <span class="op">=</span> <span class="va">z</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    light <span class="op">=</span> <span class="fu">lighting</span><span class="op">(</span>shade <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="shade_guides.html">guide_colorbar_shaded</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="lighting-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># to fade shading highlights to white, use HSL mode</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="stat_surface_3d.html">stat_surface_3d</a></span><span class="op">(</span><span class="fu"><a href="aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">z</span>, color <span class="op">=</span> <span class="va">z</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    light <span class="op">=</span> <span class="fu">lighting</span><span class="op">(</span>shade <span class="op">=</span> <span class="st">"both"</span>,</span></span>
<span class="r-in"><span>                                     shade_mode <span class="op">=</span> <span class="st">"hsl"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="shade_guides.html">guide_colorbar_shaded</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="lighting-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Alternative lighting methods -----------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># the above examples show "diffuse" lighting;</span></span></span>
<span class="r-in"><span><span class="co"># use "direct" lighting to apply full shade to unlit surfaces</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="stat_surface_3d.html">stat_surface_3d</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"gray"</span>, color <span class="op">=</span> <span class="st">"gray"</span>,</span></span>
<span class="r-in"><span>                    light <span class="op">=</span> <span class="fu">lighting</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"direct"</span>, shade <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="lighting-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># specify quantized lighting to split the scene into discrete light bins</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="stat_surface_3d.html">stat_surface_3d</a></span><span class="op">(</span><span class="fu"><a href="aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">light</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    light <span class="op">=</span> <span class="fu">lighting</span><span class="op">(</span>quanta <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="lighting-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use RGB-normal lighting plot each face direction in a unique color</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="stat_surface_3d.html">stat_surface_3d</a></span><span class="op">(</span><span class="fu"><a href="aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">light</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    light <span class="op">=</span> <span class="fu">lighting</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"normal_rgb"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="lighting-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Light source specification -----------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># light direction from upper left</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="stat_surface_3d.html">stat_surface_3d</a></span><span class="op">(</span>light <span class="op">=</span> <span class="fu">lighting</span><span class="op">(</span>shade <span class="op">=</span> <span class="st">"both"</span>,</span></span>
<span class="r-in"><span>                        direction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="lighting-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># positional lighting from within plot</span></span></span>
<span class="r-in"><span><span class="co"># p + stat_surface_3d(aes(fill = after_stat(light)),</span></span></span>
<span class="r-in"><span><span class="co">#             light = lighting(position = c(0, .5, 100),</span></span></span>
<span class="r-in"><span><span class="co">#                         distance_falloff = TRUE,</span></span></span>
<span class="r-in"><span><span class="co">#                         method = "direct"))</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew Kling.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

